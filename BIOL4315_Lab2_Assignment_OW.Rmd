---
title: "BIOL4315_Lab2_assignment_OW" (1pt)
author: "OceanneYW"
date: "2025-09-17"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 3.Install filtlong Long Reads QC (1pt)
```{bash installing filtlong, eval=FALSE}
conda search filtlong

conda create --name filtlong_env
conda activate filtlong_env
conda install filtlong=version -c channel 
```

## 4.Filtlong 75% original 
```{bash 75%, eval=FALSE}
filtlong -p 75 ERR1539001.fastq > ERR1539001_filtlong75.fastq

```

## 5.Sequali on filtered
```{bash filtered, eval=FALSE}
deactivate

conda activate sequali_env

# Check software installation and proper loading
sequali -h

# cd into the repos/BIOL4315_Lab2_OW
sequali --ourdir ./sequali_ERR1539001_75filt ERR1539001_filtlong75.fastq 

```

## 6.Differences on filtlong75 and original of ERR1539001
- The input file sizes were different, it is 0.15Gb smaller post filtering,
The mean length has increased in the filtered summary which makes sense as 
filtlong has trimmed out the shorter 25% in the original file. The range is also 
different 

##7.Sequali report on Github 

## 8. Download the Illumina reads 
```{bash, eval=FALSE}
wget -nc ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR112/040/ERR11203340/ERR11203340_1.fastq.gz
wget -nc ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR112/040/ERR11203340/ERR11203340_2.fastq.gz
```

### 9.1 Sequence quality per base per cycle, quality score drop below 2 
```{r ERR11203340, eval=FALSE}
# ERR11203340_1.fastq
sequali --outdir ./sequali_ERR11203340_1 ERR11203340_1.fastq

#ERR11203340_2.fastq
sequali --outdir ./sequali_ERR11203340_2 ERR11203340_2.fastq
```
Seem like there are both short reads with mean 101 bp.  Using *ShortRead* library instead.

```{r ShortRead, eval=TRUE}
library(Rqc)

qualityBoxPlot <- rqcReadQualityBoxPlot(rqc(path = "/Users/owang/repos/BIOL4315_Lab2_OW/ERR11203340", pattern = ".fastq", openBrowser = FALSE))

qualityBoxPlot
```


```{r, eval=TRUE}

qualityCycleBoxPlot <- rqcCycleQualityBoxPlot(rqc(path = "/Users/owang/repos/BIOL4315_Lab2_OW/ERR11203340", pattern = ".fastq", openBrowser = FALSE))

qualityCycleBoxPlot
```
Both sequences seem to have reads quality below 2 with subset 1 around cycle 101.

### 9.2 Sequence content per base per cycle
```{r Sequence Content, eval=TRUE}
nContentPlot <- rqcCycleBaseCallsLinePlot(rqc(path = "/Users/owang/repos/BIOL4315_Lab2_OW/ERR11203340", pattern = ".fastq.gz", openBrowser = FALSE))

nContentPlot
```

No Ns can be seen anywhere, it is very high quality.

### 9.3 Read frequency plot
```{r Read frequency plot, eval=TRUE}
readFreqPlot <- rqcReadFrequencyPlot(rqc(path = "/Users/owang/repos/BIOL4315_Lab2_OW/ERR11203340", pattern = ".fastq.gz", openBrowser = FALSE))

readFreqPlot
```
All sequences have more than 1 read.

## 10.Trim short reads based on quality score

Based on the graph generated from Q9.1, there are no reads with quality below 20. Therefore, no need for trimming.

If there are reads below Q20, then the following steps are taken.
```{r QuasR, eval=TRUE}
#BiocManager::install("QuasR")

library(QuasR)
fq1 = readFastq("/Users/owang/repos/BIOL4315_Lab2_OW/ERR11203340_1.fastq")
fq2 = readFastq("/Users/owang/repos/BIOL4315_Lab2_OW/ERR11203340_2.fastq")


#QuasR::preprocessReads()

```

## 11. Stage, commit and push to Github

```{r, eval=TRUE}
test <- 

test
```